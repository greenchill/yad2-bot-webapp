<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Yad2 Sniper - Filters</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script src="https://cdn.tailwindcss.com"></script>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
        }

        /* Range slider styling */
        input[type="range"] {
            -webkit-appearance: none;
            appearance: none;
            width: 100%;
            height: 6px;
            border-radius: 5px;
            background: #3b82f6;
            outline: none;
        }

        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            appearance: none;
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #2563eb;
            cursor: pointer;
        }

        input[type="range"]::-moz-range-thumb {
            width: 20px;
            height: 20px;
            border-radius: 50%;
            background: #2563eb;
            cursor: pointer;
        }

        /* Chip selection */
        .chip {
            transition: all 0.2s;
        }

        .chip.selected {
            background: #3b82f6;
            color: white;
            transform: scale(1.05);
        }
    </style>
</head>
<body class="bg-gray-900 text-white p-4">
    <div class="max-w-md mx-auto">
        <!-- Header -->
        <div class="text-center mb-6">
            <h1 class="text-2xl font-bold mb-2">ğŸ  Search Filters</h1>
            <p class="text-gray-400">Set your preferences for Tel Aviv apartments</p>
        </div>

        <!-- Price Range -->
        <div class="mb-6 bg-gray-800 p-4 rounded-lg">
            <label class="block text-sm font-semibold mb-2">ğŸ’° Max Price</label>
            <div class="flex items-center gap-4">
                <span class="text-blue-400 font-mono text-lg">â‚ª<span id="priceDisplay">10,000</span></span>
            </div>
            <input
                type="range"
                id="maxPrice"
                min="3000"
                max="25000"
                step="500"
                value="10000"
                class="mt-3"
            />
            <div class="flex justify-between text-xs text-gray-500 mt-1">
                <span>â‚ª3K</span>
                <span>â‚ª25K</span>
            </div>
        </div>

        <!-- Rooms Selection -->
        <div class="mb-6 bg-gray-800 p-4 rounded-lg">
            <label class="block text-sm font-semibold mb-3">ğŸ› Minimum Rooms</label>
            <div class="grid grid-cols-4 gap-2">
                <button class="chip selected bg-gray-700 hover:bg-gray-600 py-3 rounded-lg font-bold" data-rooms="1">
                    1
                </button>
                <button class="chip bg-gray-700 hover:bg-gray-600 py-3 rounded-lg font-bold" data-rooms="2">
                    2
                </button>
                <button class="chip bg-gray-700 hover:bg-gray-600 py-3 rounded-lg font-bold" data-rooms="3">
                    3
                </button>
                <button class="chip bg-gray-700 hover:bg-gray-600 py-3 rounded-lg font-bold" data-rooms="4">
                    4+
                </button>
            </div>
        </div>

        <!-- Private Only Toggle -->
        <div class="mb-6 bg-gray-800 p-4 rounded-lg">
            <label class="flex items-center justify-between cursor-pointer">
                <div>
                    <span class="text-sm font-semibold">ğŸš« Private Owners Only</span>
                    <p class="text-xs text-gray-400 mt-1">Hide listings from agents/agencies</p>
                </div>
                <div class="relative">
                    <input type="checkbox" id="privateOnly" class="sr-only">
                    <div class="toggle-bg w-14 h-8 bg-gray-600 rounded-full"></div>
                </div>
            </label>
        </div>

        <!-- Info Box -->
        <div class="mb-6 bg-blue-900/30 border border-blue-500/30 p-4 rounded-lg">
            <p class="text-sm text-blue-300">
                â„¹ï¸ You'll receive instant notifications when new apartments matching your criteria are posted on Yad2.
            </p>
        </div>

        <!-- Save Button (shown at bottom via Telegram) -->
        <div class="text-center text-gray-500 text-sm">
            Click "Save Filters" button below â¬‡ï¸
        </div>
    </div>

    <script>
        // Initialize Telegram Web App
        const tg = window.Telegram.WebApp;
        tg.expand();
        tg.MainButton.setText('Save Filters ğŸ””');
        tg.MainButton.show();

        // State
        let selectedRooms = 1;
        let privateOnly = false;
        let maxPrice = 10000;

        // Price slider
        const priceSlider = document.getElementById('maxPrice');
        const priceDisplay = document.getElementById('priceDisplay');

        priceSlider.addEventListener('input', (e) => {
            maxPrice = parseInt(e.target.value);
            priceDisplay.textContent = maxPrice.toLocaleString();
        });

        // Room chips
        const roomChips = document.querySelectorAll('.chip');
        roomChips.forEach(chip => {
            chip.addEventListener('click', () => {
                roomChips.forEach(c => c.classList.remove('selected'));
                chip.classList.add('selected');
                selectedRooms = parseInt(chip.dataset.rooms);
            });
        });

        // Private only toggle
        const privateCheckbox = document.getElementById('privateOnly');
        const toggleBg = document.querySelector('.toggle-bg');

        function updateToggle() {
            if (privateCheckbox.checked) {
                toggleBg.classList.add('bg-blue-600');
                toggleBg.classList.remove('bg-gray-600');
                privateOnly = true;
            } else {
                toggleBg.classList.remove('bg-blue-600');
                toggleBg.classList.add('bg-gray-600');
                privateOnly = false;
            }
        }

        toggleBg.addEventListener('click', () => {
            privateCheckbox.checked = !privateCheckbox.checked;
            updateToggle();
        });

        // Main button click
        tg.MainButton.onClick(() => {
            const data = {
                max_price: maxPrice,
                min_rooms: selectedRooms,
                private_only: privateOnly
            };

            // Send data back to bot
            tg.sendData(JSON.stringify(data));
        });

        // Set theme colors
        tg.setHeaderColor('#111827');
        tg.setBackgroundColor('#111827');
    </script>
</body>
</html>
